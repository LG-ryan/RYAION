# 📈 TradingView 차트 데이터 자동 다운로드

TradingView에서 인디케이터가 적용된 차트 데이터를 자동으로 다운로드하는 도구입니다.

## ✨ 주요 기능

- ✅ **원클릭 실행**: `all_in_one.bat` 하나로 모든 과정 자동화
- ✅ **실제 프로필 사용**: 로그인 상태, 인디케이터, 레이아웃 모두 유지
- ✅ **일괄 다운로드**: 38개 티커를 자동으로 순회하며 다운로드
- ✅ **강화된 디버그**: 포트 연결 상태 자동 확인, 상세 로그 기록
- ✅ **에러 핸들링**: 개별 티커 실패해도 다음으로 진행
- ✅ **재시도 로직**: 실패 시 최대 2회 자동 재시도
- ✅ **진행상황 저장**: 중단되어도 결과 확인 가능

## 🚀 사용 방법 (초간단!)

### **1단계: all_in_one.bat 더블클릭**

그게 전부입니다! 🎉

자동으로:
1. Chrome 종료
2. Chrome 디버그 모드 실행
3. Python 스크립트 실행
4. 데이터 다운로드

### **확인 사항 (5초 내)**

Chrome이 열리면 5초 안에 확인하세요:
- ✅ TradingView 로그인 상태
- ✅ 인디케이터가 차트에 표시됨
- ✅ 타임프레임 = 1D

## 📁 파일 구조

```
tv_export/
├── all_in_one.bat            # ⭐ 원클릭 실행 (이것만 실행하세요!)
├── tv_export.py              # 메인 스크립트
├── start_chrome_debug.bat    # Chrome 디버그 실행 (단독 사용 가능)
├── stop_chrome.bat           # Chrome 종료 (문제 발생 시)
├── run_export.bat            # Python 실행 (단독 사용 가능)
├── README.md                 # 이 파일
├── debug.log                 # 🔍 디버그 로그 (문제 발생 시 확인)
├── progress.json             # 진행상황 자동 저장
└── exports/                  # CSV 파일 저장 폴더
    ├── AMEX_IWM_1D.csv
    ├── NASDAQ_MSTR_1D.csv
    └── ...
```

## ⚙️ 설정 변경

`tv_export.py` 파일에서 수정 가능:

```python
TIMEFRAME = "1D"  # 타임프레임 변경 ("1D", "240", "1W" 등)

TICKERS = [
    "AMEX:IWM",
    "NASDAQ:MSTR",
    # ... 티커 추가/삭제
]

MAX_RETRIES = 2  # 재시도 횟수
DEBUG_PORT = 9333  # 디버그 포트 번호
```

## 🔧 문제 해결

### Chrome 연결 실패

```
❌ Chrome 디버그 포트 연결 실패!
```

**해결 방법:**
1. `all_in_one.bat` 다시 실행 (가장 간단!)
2. 안 되면:
   - 작업 관리자 열기 (Ctrl+Shift+Esc)
   - 모든 `chrome.exe` 프로세스 수동 종료
   - `all_in_one.bat` 다시 실행

### 디버그 로그 확인

문제가 계속되면 `debug.log` 파일을 확인하세요:
- 포트 연결 상태
- 각 단계별 진행 상황
- 에러 메시지 상세 정보

### 일부 티커 다운로드 실패

- 정상입니다! 개별 실패는 건너뛰고 계속 진행됩니다
- 완료 후 실패한 티커 목록을 확인하세요
- `progress.json`에서 성공/실패 내역 확인 가능

## 📊 출력 예시

```
============================================================
  🚀 TradingView 차트 데이터 자동 다운로드
============================================================

[1/3] 기존 Chrome 프로세스 종료 중...
✅ Chrome 종료 완료

[2/3] Chrome 디버그 모드 실행 중...
✅ Chrome 실행 완료 (디버그 포트: 9333)
⏳ Chrome 초기화 대기 중 (5초)...

[3/3] Python 스크립트 실행 중...
============================================================

🔍 Chrome 디버그 포트 9333 확인 중...
✅ 포트 9333 열림! (1초 소요)

🔌 Chrome에 연결 시도 중...
✅ Chrome 연결 성공!

[확인] 아래 3가지만 체크하세요:
  ✅ TradingView가 로그인 상태인지
  ✅ 차트에 '당신의 인디케이터'가 켜져 있는지
  ✅ 타임프레임이 1D 인지
👉 5초 뒤 자동 시작...

============================================================
📥 38개 티커 다운로드 시작...
============================================================

[1/38] AMEX:IWM   ✅ 성공
[2/38] NASDAQ:MSTR   ✅ 성공
[3/38] NASDAQ:NVDA   ✅ 성공
...

============================================================
✅ 다운로드 완료!
============================================================
📊 결과:
   성공: 36/38
   실패: 2/38

❌ 실패한 티커 (2개):
   - BINANCE:BTCUSDT
   - BINANCE:ETHUSDT

📁 CSV 파일 위치: ...\exports
💾 진행상황 파일: ...\progress.json
📝 디버그 로그: ...\debug.log

아무 키나 눌러 종료...
```

## 🆕 강화된 디버그 기능

### 자동 포트 확인
- Chrome 디버그 포트가 열릴 때까지 자동 대기 (최대 30초)
- 포트 연결 상태 실시간 확인

### 상세 로그 기록
- `debug.log` 파일에 모든 진행 상황 기록
- 타임스탬프 포함
- 에러 발생 시 전체 스택 트레이스 기록

### 연결 실패 시 친절한 가이드
- 문제 원인 자동 진단
- 단계별 해결 방법 제시
- 로그 파일 위치 안내

## 🎯 주의사항

- ❌ 실행 중 TradingView Chrome 창을 건드리지 마세요
- ✅ Chrome 창 최소화는 괜찮습니다
- ✅ 다른 작업은 가능 (다른 프로그램 사용 OK)

## 📦 필요한 패키지

```bash
pip install selenium
```

ChromeDriver는 Selenium이 자동으로 관리합니다.

## 🕐 예상 소요 시간

- 티커당 약 5-10초
- 전체 38개 티커: **약 5-10분**

---

## 🆘 자주 묻는 질문

### Q: "포트가 열리지 않음" 오류가 계속 나요
A: `all_in_one.bat`를 다시 실행하세요. Chrome이 완전히 종료되지 않았을 수 있습니다.

### Q: 일부 티커만 실패했어요
A: 정상입니다. 네트워크 이슈나 TradingView 데이터 문제일 수 있습니다. 나중에 다시 시도하세요.

### Q: 다운로드 중 다른 작업을 해도 되나요?
A: 네! TradingView Chrome 창만 건드리지 않으면 됩니다.

### Q: 타임프레임을 변경하고 싶어요
A: `tv_export.py`에서 `TIMEFRAME = "1D"`를 원하는 값으로 변경하세요.

### Q: 티커를 추가/제거하고 싶어요
A: `tv_export.py`에서 `TICKERS` 리스트를 수정하세요.

---

**제작일**: 2025-11-02  
**버전**: 2.0 (강화된 디버그 + 원클릭 실행)  
**용도**: TradingView 차트 데이터 자동 수집
